<!-- summary Tab -->
<div class="tabs">

  <div class="clearfix"></div>
  <ul class="nav nav-pills">
    <li role="presentation">
      <a routerLink="../summarypage">Summary</a>
    </li>
    <li role="presentation" class="active">
      <a routerLink="../gstr">Invoice Wise Detail</a>
    </li>
    <li role="presentation">
      <a routerLink="../other">Other</a>
    </li>
    <li role="presentation">
      <a routerLink="../">Submit</a>
    </li>
    <li role="presentation">
      <a routerLink="../">File</a>
    </li>
  </ul>
</div>
<div class="clearfix"></div>
<div class="section-top-20 section-bottom-10 row">

  <div class="col-md-6 col-xs-12  section-bottom-20">
    <h2 class="text-invoice">Create Invoice</h2>
  </div>
  <div class="col-md-6 col-xs-12 text-right">
    <a routerLink="../newinvoice">
      <input type="button" class="btn btn-success" value="Save Data">
    </a>

    <a routerLink="../gstr">
      <input type="button" class="btn btn-success" value="Back">
    </a>

  </div>

</div>

<div class="clearfix"> </div>
<form [formGroup]="reimburshForm">
  <div>
    <label>
      <input type="radio" [checked]="true" (change)=selectRadio() formControlName="invoiceTypeRadio" name="invoiceTypeRadio" value="Normal_Invoice">Normal Invoice</label>
    <label>
      <input type="radio" (change)=selectRadio() formControlName="invoiceTypeRadio" name="invoiceTypeRadio" value="Reverse_Charge">Reverse Charge</label>
    <label>
      <input type="radio" (change)=selectRadio() formControlName="invoiceTypeRadio" name="invoiceTypeRadio" value="E_Commerce">E-commerce</label>
    <label>
      <input type="radio" (change)=selectRadio() formControlName="invoiceTypeRadio" name="invoiceTypeRadio" value="Debit_Note">Debit Note</label>
    <label>
      <input type="radio" (change)=selectRadio() formControlName="invoiceTypeRadio" name="invoiceTypeRadio" value="Credit_Note">Credit Note</label>
  </div>

  <div class="row">
    <div class="section-bottom-10 section-top-10">
      <div class="col-md-4 col-sm-4 col-xs-12 form-group">
        <label for="inputEmail3" class="col-sm-5 control-label">Name</label>
        <div class="col-sm-7">
          <input id="customerName" type="text" class="validate filter-input" [(ngModel)]=query (keyup)=search() formControlName="name">
          <div class="suggestions" *ngIf="filteredList.length > 0">
            <div *ngFor="let item of filteredList">
              <ul>
                <li>
                  <a (click)="select(item)">{{item}}</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-sm-4 col-xs-12 form-group">
        <label for="inputEmail3" class="col-sm-5 control-label">Invoice No.</label>
        <div class="col-sm-7">
          <input type="text" class="form-control" id="invoiceNo" formControlName="invoiceNo" value="ABC12345">
        </div>
      </div>
      <div class="col-md-4 col-sm-12 col-xs-12 form-group">
        <label for="inputEmail3" class="col-sm-5 control-label">Date</label>
        <div class="col-sm-7">
          <input type="text" class="form-control" id="date" formControlName="date" value="22-11-17">
        </div>
      </div>

      <div class="col-md-4 col-sm-4 col-xs-12">
        <label for="inputEmail3" class="col-sm-5 control-label">GSTIN No</label>
        <div class="col-sm-7">
          <input type="text" class="form-control" id="gstin" formControlName="gstin" value="">
        </div>
      </div>
      <div class="col-md-4 col-sm-4 col-xs-12 form-group">
        <label for="inputEmail3" class="col-sm-5 control-label">POS</label>
        <div class="col-sm-7">
          <select class="form-control" formControlName="pos">
            <option value="0">Select State</option>
            <option *ngFor="let item of stateList" [value]="item.code"> {{item.name}}</option>
          </select>
        </div>
      </div>
      <div class="col-md-4 col-sm-12 col-xs-12 form-group">
        <label for="inputEmail3" class="col-sm-5 control-label">E-Com GSTIN</label>
        <div class="col-sm-7">
          <input type="text" [readonly]="disableEcommerceInput" class="form-control" id="eComGstin" formControlName="eComGstin">
        </div>
      </div>
    </div>
  </div>


  <div class="table-responsive gsttable">
    <table class="table table-condensed  table-hover table-bordered">
      <thead>
        <tr>
          <th value="#" colspan="1" rowspan="2" class="text-center">S.No</th>
          <th value="Description" colspan="1" rowspan="2" class="text-left">Description</th>
          <th value="Goods Services" colspan="1" rowspan="2" class="text-left">Goods Services</th>
          <th value="HSN / SAC" colspan="1" rowspan="2" class="text-center">HSN / SAC</th>
          <th value="Qty" colspan="1" rowspan="2" class="text-right">Qty</th>
          <th value="Unit of Measurement" colspan="1" rowspan="2" class="unit_of_measurement">Unit of Measurement</th>
          <th value="Taxable Value" colspan="1" rowspan="2" class="text-center">Taxable Value</th>
          <th value="Rate Of Tax" colspan="1" rowspan="2" class="text-center">Rate Of Tax</th>
          <th value="CGST" colspan="1" rowspan="2" class="text-center">CGST</th>
          <th value="SGST" colspan="1" rowspan="2" class="text-right">SGST</th>
          <th value="IGST" colspan="1" rowspan="2" class="text-center">IGST</th>
          <th value="CESS" colspan="2" rowspan="1" class="cess text-center">CESS</th>
          <th value="Total" colspan="1" rowspan="2" class="text-left">Total</th>
        </tr>
        <tr>
          <th value="IGST" colspan="1" rowspan="1" class="igst text-right">RATE</th>
          <th value="%" colspan="1" rowspan="1" class="cess text-center">AMT</th>
        </tr>

      </thead>
      <tbody formArrayName="salesList">

        <tr *ngFor="let saleList of reimburshForm.controls.salesList.controls;let i = index" [formGroupName]="i">
          <td align="center"> {{i+1}}</td>
          <td>
            <!-- <input type="text" class="form-control" formControlName="description" > -->
            <input type="text" formControlName="description" class="validate filter-input form-control" [(ngModel)]=descriptionQuery
              (keyup)=searchDescription() required>
            <div *ngIf="filteredDescriptionList.length > 0">
              <div class="completer-dropdown" *ngFor="let item of filteredDescriptionList">
                <ul class="box">
                  <li>
                    <a (click)="selectDesciption(item)">{{item.description}}</a>
                  </li>
                  <a>Add New Item</a>
                </ul>
              </div>
            </div>
          </td>
          <td>
            <select class="form-control" formControlName="goodservice">
              <option *ngFor="let sr of serice" [value]="sr">{{sr}}</option>
            </select>
          </td>
          <td>
            <input type="text" class="form-control" formControlName="hsn">
          </td>
          <td>
            <input type="text" class="form-control" formControlName="qty">
          </td>
          <td>
            <select class="form-control" formControlName="uom">
              <option *ngFor="let un of unit" [value]="un"> {{un}}</option>
            </select>
          </td>
          <td>
            <input type="text" class="form-control" formControlName="tax">
          </td>
          <td>
            <select class="form-control" formControlName="rtax">
              <option *ngFor="let rt of rate" [value]="rt"> {{rt}} </option>
            </select>
          </td>
          <td>
            <input type="text" class="form-control" formControlName="sgst">
          </td>
          <td>
            <input type="text" class="form-control" formControlName="igst">
          </td>
          <td>
            <input type="text" class="form-control" formControlName="val1">
          </td>
          <td>
            <input type="text" class="form-control" formControlName="val2">
          </td>
          <td>
            <input type="text" class="form-control" formControlName="val3">
          </td>
          <td>
            <input type="text" class="form-control" formControlName="val4" [ngModel]="saleList.get('val2').value * saleList.get('val3').value">
          </td>
          <td>
            <a *ngIf="reimburshForm.controls.salesList.controls.length > 1" (click)="deleteRow(i)">
              <i class="fa fa-trash-o fa-2x"></i>
            </a>
          </td>
        </tr>


        <tr>
          <td colspan="3" class="tableadd">
            <a (click)="addSalesListItem()"> +Add another line</a>
          </td>
          <td colspan="3" align="right">
            <b>Grand Total =</b>
          </td>
          <td colspan="1" class="tbbgcolor" align="right">
            <input readonly class="form-control" value="500">
          </td>
          <td colspan="1" align="right">
          </td>
          <td colspan="1" class="tbbgcolor" align="right">
            <input readonly class="form-control" value="500">
          </td>
          <td colspan="1" class="tbbgcolor" align="right">
            <input readonly class="form-control" value="500">
          </td>
          <td colspan="3" align="right">

          </td>
          <td class="tbbgcolor">
            <input readonly class="form-control" value="500">
          </td>
          <!-- toale{{total}} -->
          <td class="tbbgcolor">
            <input readonly class="form-control" [value]="total" formControlName="total">
          </td>
        </tr>
      </tbody>

    </table>
  </div>
  <div class="text-center section-bottom-60">
    <button class="btn btn-success btnSave_data" (click)='submitForm(reimburshForm.value)'> Save Data</button>
  </div>

  <!-- <pre>{{ myModel | json }}</pre>
  <pre>{{ myModel.salesList[0].val5 | json}}</pre> -->
</form>
<form [formGroup]="invoiceForm">
  <table>
    <thead>
      <tr>
        <th>Quantity</th>
        <th>Rate</th>
        <th>Amount</th>
      </tr>
    </thead>
    <tbody formArrayName="itemRows">
      <tr *ngFor="let itemrow of invoiceForm.controls.itemRows.controls; let i=index" [formGroupName]="i">
        <td>
          <input type="text" class="form-control" formControlName="itemqty">
        </td>
        <td>
          <input type="text" class="form-control" formControlName="itemrate">
        </td>
        <td>
          <input type="text" class="form-control" readonly formControlName="itemamt" [ngModel]="itemrow.get('itemqty').value * itemrow.get('itemrate').value">
        </td>
        <td>
          <button *ngIf="invoiceForm.controls.itemRows.controls.length > 1" (click)="deleteRow(i)" class="btn btn-danger">
            <i>Delete</i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  <br> Total sum:
  <input readonly [ngModel]="summed" formControlName="summed" />
  <br>
  <br>
  <button type="button" (click)="addNewRow()" class="btn btn-primary">Add New Row</button>
</form>